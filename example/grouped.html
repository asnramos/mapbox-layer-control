<!DOCTYPE html>
<html>

<head>
  <meta charset='utf-8' />
  <title>Mapbox Layer Control Example</title>
  <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
  <script src="mapbox-gl.js"></script>
  <link rel="stylesheet" href="mapbox-gl.css" />
  <link rel="stylesheet" href="../layerControl.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous" />  <style>
    * {
      font-family: -apple-system, BlinkMacSystemFont, Avenir, "Avenir Next",
    "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell", "Fira Sans",
    "Droid Sans", "Helvetica Neue", sans-serif;
    }
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }
  </style>
</head>

<body>

  <div id='map'></div>
  <script type="module">
    import { layerControlSimple } from "../layerControlSimple.js"
import { layerControlGrouped } from "../layerControlGrouped.js"


/*Blank Mapbox GL Map*/

var map = new mapboxgl.Map({
  container: 'map',
  hash: true,
  /*style: 'some mapbox style url*/
  /*below is a blank style*/
  style: {
    "version": 8,
    "name": "blank",
    "sources": {
      "blank": {
        "type": "vector",
        "url": ""
      }
    },
    "layers": [{
      "id": "background",
      "type": "background",
      "paint": {
        "background-color": "skyblue"
      }
    }]
  },
  center: [-97.56, 39.59],
  zoom: 4.68,
  debug: 1
});
map.addControl(new mapboxgl.NavigationControl());
map.addControl(new mapboxgl.FullscreenControl());

map.on('style.load', function() {
  map.addSource('counties', {
    'type': 'geojson',
    'data': 'counties.min.geojson'
  });


  map.addLayer({
    'id': 'Counties',
    'type': 'fill',    
    'source': 'counties',
    'layout': {
      'visibility': 'visible'
    },
    

    'paint': {
      'fill-color': 'lightgray',
      'fill-outline-color': 'white',
      'fill-opacity': 0.9
    }
  });

  map.addLayer({
    'id': 'States',
    'type': 'line',    
    'source': {
      type: "geojson",
      data: "states.geojson"
    },
    'layout': {
      'visibility': 'none'
    },
    

    'paint': {
      'line-color': '#121212',
    }
  });

  map.addLayer({
    'id': 'Lakes',
    'type': 'fill',    
    'source': {
      type: "geojson",
      data: "lakes.json"
    },
    'layout': {
      'visibility': 'none'
    },
    

    'paint': {
      'fill-color': 'blue',
      'fill-outline-color': 'white',
      'fill-opacity': 0.9
    }
  });

  map.addLayer({
    'id': 'rivers',
    'type': 'line',    
    'source': {
      type: "geojson",
      data: "rivers.geojson"
    },
    'layout': {
      'visibility': 'none'
    },
    

    'paint': {
      'line-color': 'blue',
      'line-width': 3
    }
  });

  map.addLayer({
    'id': 'Rail',
    'type': 'line',    
    'source': {
      type: "geojson",
      data: "rail.geojson"
    },
    'layout': {
      'visibility': 'none'
    },
    

    'paint': {
      'line-color': 'black',
      'line-width': 4
    }
  });

  // map.addControl( new layerControlSimple({
  //   layers: ["Counties", "Counties1", "Counties2"]
  // }), "top-left");

  map.addControl( new layerControlGrouped({
    layers: [
      {
        name: "Hydro",
        directory: "Environment",
        "legend": `
            <i class='fa fa-square' style='color:blue;'>&nbsp;</i>Lakes<br>
            <i class='fa fa-minus' style='color:blue;'>&nbsp;</i>Rivers
            `,
        mapLayers: [
          {
          "name": "Lakes",
          "id": "Lakes",
          "legend": `
            <i class='fa fa-square' style='color:blue;'>&nbsp;</i>Lakes<br>
            `,
          },
          {
            "name": "Rivers",
            "id": "rivers",
            "legend": `
            <i class='fa fa-minus' style='color:blue;'>&nbsp;</i>Rivers<br>
            `,          }
        ]
      },
      {
        name: "Transportation",
        directory: "Cultural",
        mapLayers: [
          {
          "name": "Rail",
          "id": "Rail",
          "legend": "<i class='fa fa-minus' style='color:black;'>&nbsp;</i>Railroads"
          }
        ]
      },
      {          
        name: "Admin",
        directory: "Administrative",
        mapLayers: [{
          "name": "States",
          "id": "States",
         },
         {
           "name": "Counties",
           "id": "Counties"
          }
        ]
      }
    ]
  }), "top-left");

});


/*End Blank Map*/

</script>

</body>

</html>